<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<style>
  /* 1. CSS 변수 설정: 색상 관리 */
  :root {
    --text-main: #37352f;
    --text-sub: #787774;
    --bg-input: rgba(255, 255, 255, 0.6);
    --border-color: rgba(55, 53, 47, 0.16);
    --hover-bg: rgba(55, 53, 47, 0.08);
    --accent-color: #e16259; /* 뽀모도로 레드 */
  }

  /* 2. 다크 모드 감지 및 색상 변수 변경 */
  @media (prefers-color-scheme: dark) {
    :root {
      --text-main: #d9d9d9;
      --text-sub: #9b9b9b;
      --bg-input: rgba(255, 255, 255, 0.1);
      --border-color: rgba(255, 255, 255, 0.13);
      --hover-bg: rgba(255, 255, 255, 0.08);
    }
  }

  /* 3. 기본 스타일 (배경 투명화) */
  body {
    font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
    padding: 20px;
    background-color: transparent; /* 배경 투명 */
    color: var(--text-main);
    margin: 0;
  }

  /* 타이머 스타일 */
  .timer-box { text-align: center; margin-bottom: 25px; }
  .time { font-size: 56px; font-weight: 700; font-variant-numeric: tabular-nums; letter-spacing: -2px; margin-bottom: 10px; }
  
  .btn-group { display: flex; justify-content: center; gap: 10px; }
  .btn {
    padding: 6px 16px; border: 1px solid var(--border-color); border-radius: 6px;
    background: var(--bg-input); color: var(--text-main); cursor: pointer;
    font-size: 14px; transition: background 0.2s;
  }
  .btn:hover { background: var(--hover-bg); }
  .btn.start { border-color: var(--accent-color); color: var(--accent-color); font-weight: 600; }

  /* 태스크 리스트 스타일 */
  .task-input {
    width: 100%; padding: 10px; border: 1px solid var(--border-color);
    background: var(--bg-input); color: var(--text-main);
    border-radius: 6px; box-sizing: border-box; outline: none;
    font-size: 14px;
  }
  .task-input::placeholder { color: var(--text-sub); }

  .task-list { list-style: none; padding: 0; margin-top: 15px; }
  .task-item {
    margin-bottom: 8px; padding: 8px; border-radius: 6px;
    transition: background 0.2s;
  }
  .task-item:hover { background: var(--hover-bg); }

  .task-header { display: flex; align-items: center; justify-content: space-between; cursor: pointer; user-select: none; }
  .task-title { display: flex; align-items: center; gap: 8px; font-size: 15px; }
  .checkbox { cursor: pointer; }
  .details-btn { font-size: 12px; color: var(--text-sub); background: none; border: none; }
  
  .sub-tasks {
    display: none; margin-top: 8px; padding-left: 28px;
  }
  .show { display: block; }
  
  .sub-input {
    width: 100%; padding: 8px; background: transparent;
    border: none; border-left: 2px solid var(--border-color);
    color: var(--text-sub); font-size: 13px; resize: none; outline: none;
  }
  
  /* 완료된 태스크 스타일 */
  .done { text-decoration: line-through; color: var(--text-sub); }
</style>
</head>
<body>

<div class="timer-box">
  <div class="time" id="timer">25:00</div>
  <div class="btn-group">
    <button class="btn start" onclick="startTimer()">Start</button>
    <button class="btn" onclick="resetTimer()">Reset</button>
  </div>
</div>

<input type="text" class="task-input" id="mainTaskInput" placeholder="+ 할 일 추가 (Enter)">
<ul class="task-list" id="taskList"></ul>

<script>
  // 타이머 로직 (이전과 동일)
  let timeLeft = 1500; let interval; let isRunning = false;
  
  function updateDisplay() {
    const m = Math.floor(timeLeft / 60).toString().padStart(2, '0');
    const s = (timeLeft % 60).toString().padStart(2, '0');
    document.getElementById('timer').innerText = `${m}:${s}`;
    document.title = `${m}:${s} - Pomodoro`;
  }
  
  function startTimer() {
    if(isRunning) { // 일시정지 기능 추가
      clearInterval(interval); isRunning = false;
      document.querySelector('.start').innerText = 'Resume';
      return;
    }
    isRunning = true;
    document.querySelector('.start').innerText = 'Pause';
    interval = setInterval(() => {
      timeLeft--; updateDisplay();
      if(timeLeft === 0) { 
        clearInterval(interval); isRunning = false; 
        alert('집중 시간 종료! 휴식하세요.'); 
        resetTimer(); 
      }
    }, 1000);
  }
  
  function resetTimer() { 
    clearInterval(interval); isRunning = false; timeLeft = 1500; 
    updateDisplay(); 
    document.querySelector('.start').innerText = 'Start';
  }

  // 투두 리스트 로직 (체크박스 기능 개선)
  document.getElementById('mainTaskInput').addEventListener('keypress', function (e) {
    if (e.key === 'Enter') {
      const text = this.value;
      if (!text) return;
      
      const li = document.createElement('li');
      li.className = 'task-item';
      li.innerHTML = `
        <div class="task-header">
          <span class="task-title" onclick="toggleDone(this)">
            <span>⬜</span> <span>${text}</span>
          </span>
          <button class="details-btn" onclick="toggleDetails(this)">Details ▼</button>
        </div>
        <div class="sub-tasks">
          <textarea class="sub-input" rows="2" placeholder="세부 내용 입력..."></textarea>
        </div>
      `;
      document.getElementById('taskList').appendChild(li);
      this.value = '';
    }
  });

  function toggleDetails(btn) {
    const subArea = btn.parentElement.nextElementSibling;
    subArea.classList.toggle('show');
    btn.innerText = subArea.classList.contains('show') ? 'Close ▲' : 'Details ▼';
  }

  function toggleDone(span) {
    const textSpan = span.querySelector('span:last-child');
    const iconSpan = span.querySelector('span:first-child');
    
    if (textSpan.classList.contains('done')) {
      textSpan.classList.remove('done');
      iconSpan.innerText = '⬜';
    } else {
      textSpan.classList.add('done');
      iconSpan.innerText = '✅';
    }
  }
</script>

</body>
</html>
